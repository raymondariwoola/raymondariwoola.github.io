Here is an example VBA script that can be used to refresh a Power Query in Excel using VBA:


Sub RefreshPowerQuery()
    'Refresh the Power Query
    ActiveWorkbook.Queries("Query1").Refresh
End Sub


You can run this script by opening the Visual Basic Editor (VBE) in Excel, creating a new module, and pasting the code into the module. You can then run the code by clicking the "Run" button or by pressing F5.

You can replace the "Query1" with the name of your query, you can also refresh all queries in a workbook by using this script



Sub RefreshAllPowerQueries()
    Dim qry As WorkbookQuery
    For Each qry In ActiveWorkbook.Queries
        qry.Refresh
    Next qry
End Sub


You can also schedule the refresh by using the Workbook.RefreshAll method and set the BackgroundQuery property to False or True, whether or not to refresh the query in the background.




Sub RefreshAllPowerQueries()
    ActiveWorkbook.RefreshAll BackgroundQuery:=False
End Sub


It's also important to note that to run the script, you need to enable the "Microsoft Power Query for Excel" add-in, and you need to have the latest version of Excel.
