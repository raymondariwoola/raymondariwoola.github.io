'  Excel VBA script that will import the contents of a folder into a worksheet

Sub ImportFolder()
    Dim fso As Object
    Dim fld As Object
    Dim fil As Object
    Dim i As Integer
    Dim ws As Worksheet

    'create a new worksheet
    Set ws = ThisWorkbook.Sheets.Add

    'set the initial row number
    i = 1

    'create an instance of the FileSystemObject
    Set fso = CreateObject("Scripting.FileSystemObject")

    'set the folder you want to import
    Set fld = fso.GetFolder("C:\your\folder\path")

    'loop through each file in the folder
    For Each fil In fld.Files
        'write the file name to column A
        ws.Cells(i, 1).Value = fil.Name

        'write the file path to column B
        ws.Cells(i, 2).Value = fil.Path

        'write the file size to column C
        ws.Cells(i, 3).Value = fil.Size

        'write the file type to column D
        ws.Cells(i, 4).Value = fil.Type

        'increment the row number
        i = i + 1
    Next fil
End Sub







Sub ImportFolder()
    Dim fso As Object
    Dim folder As Object
    Dim file As Object
    Dim i As Integer
    Dim ws As Worksheet
    
    'Set the folder path
    folderPath = "C:\example\"
    
    'Create a new worksheet
    Set ws = ThisWorkbook.Sheets.Add
    ws.Name = "Imported Files"
    
    'Create a File System Object
    Set fso = CreateObject("Scripting.FileSystemObject")
    
    'Get the folder object
    Set folder = fso.GetFolder(folderPath)
    
    'Add the headers to the worksheet
    ws.Cells(1, 1) = "File Name"
    ws.Cells(1, 2) = "File Path"
    ws.Cells(1, 3) = "File Size (bytes)"
    
    'Loop through the files in the folder
    i = 2
    For Each file In folder.Files
        'Add the file name, path, and size to the worksheet
        ws.Cells(i, 1) = file.Name
        ws.Cells(i, 2) = file.Path
        ws.Cells(i, 3) = file.Size
        i = i + 1
    Next file
End Sub
